@using OpBot.Cards.Quiz
@inherits CardView<DefaultModel>

<Card xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <Version Major="1" Minor="4" />
    <TextBlock Size="ExtraLarge" Weight="Bolder">Math Quiz</TextBlock>
    @if (Model.TotalGuesses > 0)
    {
        <Container Style="Emphasis">
            <TextBlock>You have guessed correct @(((float)Model.CorrectGuesses / (float)Model.TotalGuesses).ToString("0.0%"))% of the time.</TextBlock>
        </Container>
    }
    <TextBlock Size="Medium" Wdith="Bolder">What is @Model.Number1 + @Model.Number2?</TextBlock>
    <Input.Text Id="answer" Label="Your answer?" Placeholder="Enter in your answer as a number."/>

    <Action.Execute Title="Submit" Verb="OnSubmit" />

</Card>

@functions {
    public void OnSubmit(string answer)
    {
        if (!int.TryParse(answer, out int result))
        {
            AddBannerMessage($"{answer} is not a integer.", AdaptiveContainerStyle.Attention);
            return;
        }

        if (Model.CheckAnswer(result) == false)
        {
            AddBannerMessage($"{result} is not correct. The correct answer is {Model.Number1 + Model.Number2}", AdaptiveContainerStyle.Attention);
        }
        else
        {
            AddBannerMessage($"{result} is correct.", AdaptiveContainerStyle.Good);
        }
        Model.NextQuestion();
    }
}