@using Newtonsoft.Json
@using OpBot.Cards.Address
@using System.ComponentModel

@inherits CardView<AddressApp, EditAddressModel>

<Card xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="1.5">
    @if (Model.IsEdit)
    {
        <TextBlock Size="ExtraLarge">Edit Address</TextBlock>
    }
    else
    {
        <TextBlock Size="ExtraLarge">Add Address</TextBlock>
    }

    <Input.Text Binding="Model.Address.Street" />
    <ValidationErrors Binding="Model.Address.Street"/>

    <Input.Text Binding="Model.Address.City" />
    <ValidationErrors Binding="Model.Address.City" />

    <Input.ChoiceSet Binding="Model.Address.State" />
    <ValidationErrors Binding="Model.Address.State" />

    <Input.Text Binding="Model.Address.PostalCode" />
    <ValidationErrors Binding="Model.Address.PostalCode" />

    <Input.ChoiceSet Binding="Model.Address.Country" />
    <ValidationErrors Binding="Model.Address.Country" />

    <Action.Execute Title="Cancel" Verb="OnCancel" AssociatedInputs="None" />
    <Action.Execute Title="Save" Verb="OnSave" />
</Card>

@functions {
    public void OnSave()
    {
        if (this.IsModelValid)
        {
            this.Close(Model);
        }
        else
        {
            AddBannerMessage("Please correct the errors in this form", AdaptiveContainerStyle.Attention);
        }
    }

    public void OnCancel()
    {
        this.Cancel("No changes made.");
    }
}